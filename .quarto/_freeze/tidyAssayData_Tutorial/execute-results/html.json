{
  "hash": "e3919f9d41ca48dbb9f7cd3d054e5047",
  "result": {
    "markdown": "---\ntitle: \"tidyAssayData Tutorial\"\nauthor: \"Ifedayo Ojo\"\nformat: html\n---\n\n\n## Background\n\nFollowing the extraction of gene expression count data for either DNA microarray or RNA sequence analysis from the database or as an output of the NGS pipeline, it is required to perform a transformation task that enables us to have clean column names that represent the samples of the study. The count data usually present with the sample identified that is stacked with some other information that will not be required in the analysis. Therefore we are continuously faced with the daunting task of transforming the column name to a tidy one.\n\n## The tidyAssayData Package\n\nWith the aim to make the transformation of the count data column names easy, I present `transformMatrixcol()` function from the TidyAssayData package. This function will be useful in the transformation phase of a typical gene expression count data ETL pipeline.\n\n## Installation\n\nYou can install the tidyAssayData package using `devtools`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Packages\"}\nlibrary(devtools)\ndevtools::install_github(\"pharmlovex/tidyAssayData\")\n```\n:::\n\n\n## Import example count data\n\nTo demonstrate how the `transformMatrixCol()` function works, I am going to import count data from gotten from different studies available on the NCBI GEO database.\n\n\n### Import data\nload RNA sequence data obtained from NGS pipeline for processing of raw data. \n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| warning: false\n# Load library\nlibrary(tidyAssayData)\nlibrary(dplyr)\n\n# Load count data\ndf <- read.delim(\"https://raw.githubusercontent.com/biodata-machine/tidyAssayData/main/counts.txt\", \n                 sep = \"\", header = TRUE, row.names = 1, comment.char = \"#\", dec = \".\")\n\n# Remove first 5 columns as it is not required for the analysis \ndf = df %>% \n     select(-c(1:5))\n\nhead(df,5)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n            mapped.SRR6176429.bam mapped.SRR6176430.bam mapped.SRR6176431.bam\ngene-Rv0001                  2657                  3544                  2715\ngene-Rv0002                  1127                  1350                  1172\ngene-Rv0003                   876                  1085                  1007\ngene-Rv0004                   537                   589                   549\ngene-Rv0005                 12152                 15908                 14242\n            mapped.SRR6176432.bam mapped.SRR6176433.bam mapped.SRR6176434.bam\ngene-Rv0001                  1680                  2444                  3546\ngene-Rv0002                  1151                  1474                  1022\ngene-Rv0003                   960                  1122                   677\ngene-Rv0004                   499                   601                   432\ngene-Rv0005                 11901                 14317                 10794\n            mapped.SRR6176435.bam mapped.SRR6176436.bam mapped.SRR6176437.bam\ngene-Rv0001                  3526                  1339                  4206\ngene-Rv0002                  1132                   492                  1528\ngene-Rv0003                   667                   501                  1392\ngene-Rv0004                   415                   292                   668\ngene-Rv0005                  9579                  7758                 20865\n            mapped.SRR6176438.bam mapped.SRR6176439.bam mapped.SRR6176440.bam\ngene-Rv0001                  4596                  1621                  3188\ngene-Rv0002                  1894                   517                  1148\ngene-Rv0003                  2071                   262                  1272\ngene-Rv0004                   944                   111                   616\ngene-Rv0005                 28060                  2849                 23132\n```\n:::\n:::\n\n\n### Transform the column names\n\nBefore applying the function, let's quickly consider the augments of the function.\n\n-   exprMat: count data frame (as a data frame)\n\n-   Sep: delimiter between the sample identifier and appendages\n\n-   nSep: count of the Delimiter\n\n-   pos: position (index) of the sample identifier\n\nNow lets apply the function\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntransform_df = transformMatrixCol(expMat = df,\n                                  Sep = \".\",\n                                  nSep = 2,\n                                  pos = 2)\n\nhead(transform_df,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            SRR6176429 SRR6176430 SRR6176431 SRR6176432 SRR6176433 SRR6176434\ngene-Rv0001       2657       3544       2715       1680       2444       3546\ngene-Rv0002       1127       1350       1172       1151       1474       1022\ngene-Rv0003        876       1085       1007        960       1122        677\ngene-Rv0004        537        589        549        499        601        432\ngene-Rv0005      12152      15908      14242      11901      14317      10794\n            SRR6176435 SRR6176436 SRR6176437 SRR6176438 SRR6176439 SRR6176440\ngene-Rv0001       3526       1339       4206       4596       1621       3188\ngene-Rv0002       1132        492       1528       1894        517       1148\ngene-Rv0003        667        501       1392       2071        262       1272\ngene-Rv0004        415        292        668        944        111        616\ngene-Rv0005       9579       7758      20865      28060       2849      23132\n```\n:::\n:::\n\n\n## Let's try another count data \n\n### Import data\nLoad a DNA microarray count data from a study in NCBI GEO database with accession number GSE158643   \n\n\n::: {.cell}\n\n```{.r .cell-code}\nurls = \"https://raw.githubusercontent.com/pharmlovex/ETLPipeline-DNAmicroarray/main/GSE158643_expr.csv\"\ndf <- read.delim(urls, header = TRUE, sep = \",\",\n                row.names = 1)\n\nhead(df,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        GSM4804913_LNCAP_CO_2_HuGene.1_0.st.v1_.CEL\n7892501                                    6.904828\n7892502                                    5.812288\n7892503                                    3.520698\n7892504                                    8.764470\n7892505                                    3.074535\n        GSM4804914_LNCAP_CTL_1_HuGene.1_0.st.v1_.CEL\n7892501                                     7.380824\n7892502                                     2.765083\n7892503                                     2.826773\n7892504                                     9.794184\n7892505                                     3.572457\n        GSM4804915_LNCAP_CTL_2_HuGene.1_0.st.v1_.CEL\n7892501                                     8.501313\n7892502                                     4.965421\n7892503                                     3.028078\n7892504                                     9.236701\n7892505                                     3.156453\n        GSM4804916_DU145_CO_1_HuGene.1_0.st.v1_.CEL\n7892501                                    5.206744\n7892502                                    5.947775\n7892503                                    2.828441\n7892504                                    8.172379\n7892505                                    3.891313\n        GSM4804917_DU145_CO_2_HuGene.1_0.st.v1_.CEL\n7892501                                    5.164993\n7892502                                    4.858495\n7892503                                    2.578302\n7892504                                    8.775429\n7892505                                    3.002443\n        GSM4804918_DU145_CTL_1_HuGene.1_0.st.v1_.CEL\n7892501                                     4.837603\n7892502                                     4.629542\n7892503                                     3.288168\n7892504                                     9.256136\n7892505                                     3.910643\n        GSM4804919_DU145_CTL_2_HuGene.1_0.st.v1_.CEL\n7892501                                     4.713379\n7892502                                     3.980863\n7892503                                     2.977510\n7892504                                     8.665889\n7892505                                     3.337936\n        GSM4804920_LNCAP_CO_1_HuGene.1_0.st.v1_.CEL\n7892501                                    7.487105\n7892502                                    6.267868\n7892503                                    3.349867\n7892504                                    8.572407\n7892505                                    3.336003\n        GSM4804921_2_astro_lncap_HuGene.1_0.st.v1_.CEL\n7892501                                       5.806061\n7892502                                       4.742291\n7892503                                       2.864958\n7892504                                       8.398879\n7892505                                       3.010074\n        GSM4804922_2_astrocito_HuGene.1_0.st.v1_.CEL\n7892501                                     6.087450\n7892502                                     4.772105\n7892503                                     2.823199\n7892504                                     8.936036\n7892505                                     3.405757\n        GSM4804923_1_astro_du145_HuGene.1_0.st.v1_.CEL\n7892501                                       3.835524\n7892502                                       4.272858\n7892503                                       3.681819\n7892504                                       9.120992\n7892505                                       4.170316\n        GSM4804924_1_astro_lncap_HuGene.1_0.st.v1_.CEL\n7892501                                       5.160502\n7892502                                       4.720987\n7892503                                       2.978415\n7892504                                       8.696909\n7892505                                       3.188487\n        GSM4804925_1_astrocito_HuGene.1_0.st.v1_.CEL\n7892501                                     6.286243\n7892502                                     4.592906\n7892503                                     3.389678\n7892504                                     8.581454\n7892505                                     3.255882\n        GSM4804926_2_astro_du145_HuGene.1_0.st.v1_.CEL\n7892501                                       4.878263\n7892502                                       4.521671\n7892503                                       3.146955\n7892504                                       9.216972\n7892505                                       2.909145\n```\n:::\n:::\n\n\n### Apply function \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_transform <- transformMatrixCol(expMat = df,\n                                   Sep = \"_\",\n                                   nSep = 6,\n                                   pos = 1)\n\nhead(df_transform)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        GSM4804913 GSM4804914 GSM4804915 GSM4804916 GSM4804917 GSM4804918\n7892501   6.904828   7.380824   8.501313   5.206744   5.164993   4.837603\n7892502   5.812288   2.765083   4.965421   5.947775   4.858495   4.629542\n7892503   3.520698   2.826773   3.028078   2.828441   2.578302   3.288168\n7892504   8.764470   9.794184   9.236701   8.172379   8.775429   9.256136\n7892505   3.074535   3.572457   3.156453   3.891313   3.002443   3.910643\n7892506   4.097385   5.219914   4.313771   4.771196   4.355183   4.213146\n        GSM4804919 GSM4804920 GSM4804921 GSM4804922 GSM4804923 GSM4804924\n7892501   4.713379   7.487105   5.806061   6.087450   3.835524   5.160502\n7892502   3.980863   6.267868   4.742291   4.772105   4.272858   4.720987\n7892503   2.977510   3.349867   2.864958   2.823199   3.681819   2.978415\n7892504   8.665889   8.572407   8.398879   8.936036   9.120992   8.696909\n7892505   3.337936   3.336003   3.010074   3.405757   4.170316   3.188487\n7892506   4.081464   5.761013   3.976960   4.049248   4.316477   4.887078\n        GSM4804925 GSM4804926\n7892501   6.286243   4.878263\n7892502   4.592906   4.521671\n7892503   3.389678   3.146955\n7892504   8.581454   9.216972\n7892505   3.255882   2.909145\n7892506   4.445348   3.505868\n```\n:::\n:::\n\n## Finally the third demostration of application of the function \n\n### Import data \nLoad a DNA micro array count data of a study with accession number GSE55945\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurls = \"https://raw.githubusercontent.com/pharmlovex/ETLPipeline-DNAmicroarray/main/GSE55945_expr.csv\"\ndf <- read.delim(urls, header = TRUE, sep = \",\",\n                row.names = 1)\n\nhead(df,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          GSM1348933_011508_HGU133_PLUS_2.0_MS_36D6.CEL\n1007_s_at                                      9.991477\n1053_at                                        7.691397\n117_at                                         5.983557\n121_at                                         5.817680\n1255_g_at                                      2.490914\n          GSM1348934_110607_HGU133_PLUS_2.0_MS_36C1.CEL\n1007_s_at                                      9.884199\n1053_at                                        7.157873\n117_at                                         5.329473\n121_at                                         5.902699\n1255_g_at                                      2.465105\n          GSM1348935_011508_HGU133_PLUS_2.0_MS_36D7.CEL\n1007_s_at                                     10.001607\n1053_at                                        7.006980\n117_at                                         4.844578\n121_at                                         5.734552\n1255_g_at                                      2.737927\n          GSM1348936_011508_HGU133_PLUS_2.0_MS_36D8.CEL\n1007_s_at                                     10.228229\n1053_at                                        7.226520\n117_at                                         6.202345\n121_at                                         5.850842\n1255_g_at                                      2.464717\n          GSM1348938_110607_HGU133_PLUS_2.0_MS_36C4.CEL\n1007_s_at                                     10.241452\n1053_at                                        7.383506\n117_at                                         5.810763\n121_at                                         5.653722\n1255_g_at                                      2.341199\n          GSM1348939_092707_HGU133_PLUS_2.0_NUGEN_TEST07.CEL\n1007_s_at                                           9.444288\n1053_at                                             6.924715\n117_at                                              5.957557\n121_at                                              5.901353\n1255_g_at                                           3.068366\n          GSM1348940_110607_HGU133_PLUS_2.0_MS_36C8.CEL\n1007_s_at                                     10.615160\n1053_at                                        7.246976\n117_at                                         6.123938\n121_at                                         5.629536\n1255_g_at                                      2.437844\n          GSM1348941_110807_HGU133_PLUS_2.0_MS_36A1.CEL\n1007_s_at                                     10.213961\n1053_at                                        7.289172\n117_at                                         5.459237\n121_at                                         5.568359\n1255_g_at                                      2.279069\n          GSM1348942_110607_HGU133_PLUS_2.0_MS_36C2.CEL\n1007_s_at                                     10.289259\n1053_at                                        7.038109\n117_at                                         5.225692\n121_at                                         5.388865\n1255_g_at                                      2.348351\n          GSM1348943_110607_HGU133_PLUS_2.0_MS_36C3.CEL\n1007_s_at                                     10.909372\n1053_at                                        7.180767\n117_at                                         6.615794\n121_at                                         5.757363\n1255_g_at                                      2.234805\n          GSM1348944_011508_HGU133_PLUS_2.0_MS_36C9.CEL\n1007_s_at                                     10.364307\n1053_at                                        7.465574\n117_at                                         5.693298\n121_at                                         5.649767\n1255_g_at                                      2.438624\n          GSM1348945_092707_HGU133_PLUS_2.0_NUGEN_TEST05.CEL\n1007_s_at                                          10.003841\n1053_at                                             7.075762\n117_at                                              5.959141\n121_at                                              6.281441\n1255_g_at                                           2.406546\n          GSM1348946_110607_HGU133_PLUS_2.0_MS_36C6.CEL\n1007_s_at                                      9.796519\n1053_at                                        7.097667\n117_at                                         6.362296\n121_at                                         5.360538\n1255_g_at                                      2.331987\n          GSM1348947_110607_HGU133_PLUS_2.0_MS_36C7.CEL\n1007_s_at                                     10.461698\n1053_at                                        7.472731\n117_at                                         6.788785\n121_at                                         6.031708\n1255_g_at                                      2.529830\n          GSM1348949_011508_HGU133_PLUS_2.0_MS_36D3.CEL\n1007_s_at                                     10.148979\n1053_at                                        7.097682\n117_at                                         5.263395\n121_at                                         5.515413\n1255_g_at                                      2.636593\n          GSM1348950_011508_HGU133_PLUS_2.0_MS_36D4.CEL\n1007_s_at                                     10.308416\n1053_at                                        7.500263\n117_at                                         5.631823\n121_at                                         5.826804\n1255_g_at                                      2.224224\n          GSM1348951_011508_HGU133_PLUS_2.0_MS_36D5.CEL\n1007_s_at                                     10.164578\n1053_at                                        7.132205\n117_at                                         5.654953\n121_at                                         5.215922\n1255_g_at                                      2.382408\n          GSM1348952_110807_HGU133_PLUS_2.0_MS_36A4.CEL\n1007_s_at                                     10.758033\n1053_at                                        6.966189\n117_at                                         6.773504\n121_at                                         5.550213\n1255_g_at                                      2.235432\n          GSM1348953_110807_HGU133_PLUS_2.0_MS_36A5.CEL\n1007_s_at                                     10.306449\n1053_at                                        7.190906\n117_at                                         6.243322\n121_at                                         5.325679\n1255_g_at                                      2.441954\n```\n:::\n:::\n\n### Apply function to transform the column name \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_transform <- transformMatrixCol(expMat = df,\n                                   Sep = \"_\",\n                                   nSep = 6,\n                                   pos = 1)\n\nhead(df_transform)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          GSM1348933 GSM1348934 GSM1348935 GSM1348936 GSM1348938 GSM1348939\n1007_s_at   9.991477   9.884199  10.001607  10.228229  10.241452   9.444288\n1053_at     7.691397   7.157873   7.006980   7.226520   7.383506   6.924715\n117_at      5.983557   5.329473   4.844578   6.202345   5.810763   5.957557\n121_at      5.817680   5.902699   5.734552   5.850842   5.653722   5.901353\n1255_g_at   2.490914   2.465105   2.737927   2.464717   2.341199   3.068366\n1294_at     8.908288   7.000133   8.338459   8.637678   8.047593   6.840393\n          GSM1348940 GSM1348941 GSM1348942 GSM1348943 GSM1348944 GSM1348945\n1007_s_at  10.615160  10.213961  10.289259  10.909372  10.364307  10.003841\n1053_at     7.246976   7.289172   7.038109   7.180767   7.465574   7.075762\n117_at      6.123938   5.459237   5.225692   6.615794   5.693298   5.959141\n121_at      5.629536   5.568359   5.388865   5.757363   5.649767   6.281441\n1255_g_at   2.437844   2.279069   2.348351   2.234805   2.438624   2.406546\n1294_at     8.721120   7.376658   8.016912   8.962868   8.989413   7.302721\n          GSM1348946 GSM1348947 GSM1348949 GSM1348950 GSM1348951 GSM1348952\n1007_s_at   9.796519  10.461698  10.148979  10.308416  10.164578  10.758033\n1053_at     7.097667   7.472731   7.097682   7.500263   7.132205   6.966189\n117_at      6.362296   6.788785   5.263395   5.631823   5.654953   6.773504\n121_at      5.360538   6.031708   5.515413   5.826804   5.215922   5.550213\n1255_g_at   2.331987   2.529830   2.636593   2.224224   2.382408   2.235432\n1294_at     8.776370   9.475852   7.691538   8.230438   8.208712   8.262031\n          GSM1348953\n1007_s_at  10.306449\n1053_at     7.190906\n117_at      6.243322\n121_at      5.325679\n1255_g_at   2.441954\n1294_at     8.144334\n```\n:::\n:::\n\n\n## Conclusion \n\ntidyAssayData package provides a `transformMatrixCol()` function that allow easy \nway to tidy up the column names of count data. Therefore it will be worth adding to your expression gene analysis toolkit.  \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}